<Window x:Class="AUTOO.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:AUTOO"
        mc:Ignorable="d"
        Title="Автопредприятие" 
        Height="700" Width="1000"
        WindowStartupLocation="CenterScreen">

    <Window.Resources>
        <Style TargetType="Button">
            <Setter Property="Margin" Value="5"/>
            <Setter Property="Padding" Value="10,5"/>
            <Setter Property="Background" Value="#2196F3"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#1976D2"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Cursor" Value="Hand"/>
        </Style>

        <Style TargetType="DataGrid">
            <Setter Property="Margin" Value="5"/>
            <Setter Property="AutoGenerateColumns" Value="False"/>
            <Setter Property="SelectionMode" Value="Single"/>
            <Setter Property="CanUserAddRows" Value="False"/>
            <Setter Property="CanUserDeleteRows" Value="False"/>
            <Setter Property="VerticalGridLinesBrush" Value="#E0E0E0"/>
            <Setter Property="HorizontalGridLinesBrush" Value="#E0E0E0"/>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Заголовок -->
        <Border Grid.Row="0" Background="#2196F3" Padding="15">
            <TextBlock Text="АВТОПРЕДПРИЯТИЕ" 
                      Foreground="White" 
                      FontSize="24" 
                      FontWeight="Bold"
                      HorizontalAlignment="Center"/>
        </Border>

        <!-- Основное содержимое -->
        <TabControl Grid.Row="1" Margin="10">
            <!-- Вкладка Транспорт -->
            <TabItem Header="🚗 Транспорт">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                        <Button Content="➕ Добавить транспорт" 
                                Command="{Binding AddVehicleCommand}"
                                ToolTip="Добавить новое транспортное средство"/>
                        <Button Content="🗑️ Удалить выбранный" 
                                Command="{Binding DeleteVehicleCommand}"
                                ToolTip="Удалить выбранное транспортное средство"/>
                        <Button Content="🔧 Добавить ремонт" 
                                Command="{Binding AddRepairCommand}"
                                ToolTip="Добавить запись о ремонте"/>
                        <Button Content="📦 Добавить перевозку" 
                                Command="{Binding AddCargoTransportationCommand}"
                                ToolTip="Добавить запись о грузоперевозке"/>
                        <Button Content="📊 Статистика" 
                                Command="{Binding ShowStatisticsCommand}"
                                ToolTip="Показать статистику"/>
                    </StackPanel>

                    <DataGrid Grid.Row="1" 
                             ItemsSource="{Binding Vehicles}" 
                             SelectedItem="{Binding SelectedVehicle}"
                             SelectionMode="Single">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Гос. номер" Binding="{Binding LicensePlate}" Width="100"/>
                            <DataGridTextColumn Header="Марка" Binding="{Binding Brand}" Width="120"/>
                            <DataGridTextColumn Header="Модель" Binding="{Binding Model}" Width="120"/>
                            <DataGridTextColumn Header="Тип" Binding="{Binding Type}" Width="100"/>
                            <DataGridTextColumn Header="Пробег" Binding="{Binding CurrentMileage}" Width="80"/>
                            <DataGridTextColumn Header="Дата покупки" Binding="{Binding PurchaseDate, StringFormat=d}" Width="100"/>
                            <DataGridTextColumn Header="Вместимость" Binding="{Binding Capacity}" Width="80"/>
                            <DataGridTextColumn Header="Грузоподъемность" Binding="{Binding LoadCapacity}" Width="100"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- Вкладка Водители -->
            <TabItem Header="👨‍✈️ Водители">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                        <Button Content="➕ Добавить водителя" Command="{Binding AddDriverCommand}"/>
                        <Button Content="🗑️ Удалить выбранного" Command="{Binding DeleteDriverCommand}"/>
                    </StackPanel>

                    <DataGrid Grid.Row="1" 
                             ItemsSource="{Binding Drivers}" 
                             SelectedItem="{Binding SelectedDriver}">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Фамилия" Binding="{Binding LastName}" Width="120"/>
                            <DataGridTextColumn Header="Имя" Binding="{Binding FirstName}" Width="120"/>
                            <DataGridTextColumn Header="Отчество" Binding="{Binding MiddleName}" Width="120"/>
                            <DataGridTextColumn Header="Номер прав" Binding="{Binding LicenseNumber}" Width="100"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- Вкладка Ремонты -->
            <TabItem Header="🔧 Ремонты">
                <DataGrid ItemsSource="{Binding Repairs}">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="ID ТС" Binding="{Binding VehicleId}" Width="60"/>
                        <DataGridTextColumn Header="Дата" Binding="{Binding RepairDate, StringFormat=d}" Width="100"/>
                        <DataGridTextColumn Header="Стоимость" Binding="{Binding Cost, StringFormat=C}" Width="100"/>
                        <DataGridTextColumn Header="Описание" Binding="{Binding Description}" Width="*"/>
                    </DataGrid.Columns>
                </DataGrid>
            </TabItem>

            <!-- Вкладка Запросы -->
            <TabItem Header="📋 Запросы">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="10">
                        <GroupBox Header="📊 Список запросов" Padding="10" FontWeight="Bold">
                            <StackPanel>
                                <Button Content="1. 📋 Данные об автопарке предприятия" 
                                        Command="{Binding Query1Command}"
                                        Margin="0,2"
                                        ToolTip="Получить данные об автопарке предприятия"/>

                                <Button Content="2. 👨‍✈️ Водители предприятия" 
                                        Command="{Binding Query2Command}"
                                        Margin="0,2"
                                        ToolTip="Получить перечень и общее число водителей"/>

                                <Button Content="3. 🚗 Распределение водителей по автомобилям" 
                                        Command="{Binding Query3Command}"
                                        Margin="0,2"
                                        ToolTip="Распределение водителей по автомобилям"/>

                                <Button Content="4. 🚌 Транспорт по маршрутам" 
                                        Command="{Binding Query4Command}"
                                        Margin="0,2"
                                        ToolTip="Распределение пассажирского транспорта по маршрутам"/>

                                <Button Content="5. 🛣️ Пробег транспорта" 
                                        Command="{Binding Query5Command}"
                                        Margin="0,2"
                                        ToolTip="Сведения о пробеге автотранспорта"/>

                                <Button Content="6. 💰 Статистика ремонтов" 
                                        Command="{Binding Query6Command}"
                                        Margin="0,2"
                                        ToolTip="Данные о числе ремонтов и их стоимости"/>

                                <Button Content="7. 👥 Структура персонала" 
                                        Command="{Binding Query7Command}"
                                        Margin="0,2"
                                        ToolTip="Данные о подчиненности персонала"/>

                                <Button Content="8. 🏢 Гаражное хозяйство" 
                                        Command="{Binding Query8Command}"
                                        Margin="0,2"
                                        ToolTip="Сведения о наличии гаражного хозяйства"/>

                                <Button Content="9. 📦 Грузоперевозки" 
                                        Command="{Binding Query9Command}"
                                        Margin="0,2"
                                        ToolTip="Сведения о грузоперевозках"/>

                                <Button Content="10. 🔩 Узлы и агрегаты" 
                                        Command="{Binding Query10Command}"
                                        Margin="0,2"
                                        ToolTip="Данные о числе использованных узлов и агрегатов"/>

                                <Button Content="11. 📈 Поступление/списание" 
                                        Command="{Binding Query11Command}"
                                        Margin="0,2"
                                        ToolTip="Сведения о купленной и списанной автотехнике"/>

                                <Button Content="12. 👷 Состав бригады" 
                                        Command="{Binding Query12Command}"
                                        Margin="0,2"
                                        ToolTip="Состав подчиненных указанного бригадира"/>

                                <Button Content="13. 🛠️ Работы специалистов" 
                                        Command="{Binding Query13Command}"
                                        Margin="0,2"
                                        ToolTip="Данные о работах, выполненных специалистами"/>
                            </StackPanel>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Вкладка Отчеты -->
            <TabItem Header="📊 Отчеты">
                <StackPanel Margin="20">
                    <TextBlock Text="Быстрые отчеты" FontSize="16" FontWeight="Bold" Margin="0,0,0,10"/>

                    <Button Content="📈 Общая статистика" 
                            Command="{Binding ShowStatisticsCommand}"
                            Margin="0,5" Padding="20,10"/>

                    <Button Content="💰 Финансовый отчет" 
                            Command="{Binding Query6Command}"
                            Margin="0,5" Padding="20,10"/>

                    <Button Content="🚗 Отчет по транспорту" 
                            Command="{Binding Query1Command}"
                            Margin="0,5" Padding="20,10"/>
                </StackPanel>
            </TabItem>
        </TabControl>

        <!-- Панель статуса -->
        <StatusBar Grid.Row="2" Background="#F5F5F5">
            <StatusBarItem>
                <TextBlock Text="Транспорт:" FontWeight="Bold"/>
            </StatusBarItem>
            <StatusBarItem>
                <TextBlock Text="{Binding Vehicles.Count}"/>
            </StatusBarItem>

            <Separator/>

            <StatusBarItem>
                <TextBlock Text="Водители:" FontWeight="Bold"/>
            </StatusBarItem>
            <StatusBarItem>
                <TextBlock Text="{Binding Drivers.Count}"/>
            </StatusBarItem>

            <Separator/>

            <StatusBarItem>
                <TextBlock Text="Ремонты:" FontWeight="Bold"/>
            </StatusBarItem>
            <StatusBarItem>
                <TextBlock Text="{Binding Repairs.Count}"/>
            </StatusBarItem>

            <Separator/>

            <StatusBarItem>
                <TextBlock Text="Гаражи:" FontWeight="Bold"/>
            </StatusBarItem>
            <StatusBarItem>
                <TextBlock Text="{Binding Garages.Count}"/>
            </StatusBarItem>
        </StatusBar>

        <!-- Строка состояния -->
        <Border Grid.Row="3" Background="#E3F2FD" Padding="5">
            <TextBlock Text="{Binding StatusMessage}" 
                      FontStyle="Italic"
                      TextTrimming="CharacterEllipsis"/>
        </Border>
    </Grid>
</Window>